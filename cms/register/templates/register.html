<html>
    <head>
        <meta charset="utf-8">

        <title>Habbelix: Escolha seu sexo e sua data de nascimento!</title>

        <link type="text/css" href="{{ url_for('static', filename='css/registration.css') }}" rel="stylesheet">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
       
    </head>

    <body>
        <div class="main" style="margin-top: 100px">
            <div class="logo"></div>

            <div class="content-box" id="step-1">
                <div class="title-box">
                    <div class="title">Credenciais</div>
                    <div class="steps">1 / 3</div>
                </div>

                <div class="png20">
                    <form action="/register/step1" method="POST">

                        <label for="register-mail">Digite seu e-mail</label>
                        <input type="text" id="register-mail" name="register-mail" onblur="searchEmail()" required>
                        <!-- <p class="desc">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</p> -->

                        <label for="register-username">Escolha um nick</label>
                        <input type="text" id="register-username" name="register-username" value="" required>
                        <!-- <p class="desc">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</p> -->

                        <!-- <div class="alert">Du musst eine E-Mail Adresse angeben.</div> -->

                        <label for="register-password">Senha</label>
                        <input type="password" id="register-password" name="register-password" required>
                        <!-- <p class="desc">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</p> -->

                        <!-- <div class="alert">Die angebenen Passwörter stimmen nicht überein!</div> -->

                        <label for="register-password-confirm">Confirme a senha</label>
                        <input type="password" id="register-password-confirm" name="register-password-confirm" onblur="confirmPassword()" required>

                        <span id='message'></span>
                        <!-- <p class="desc">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</p> -->
                       
                        <p class="desc">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</p>

                        <div style="clear:both"></div>

                        <a href="/" class="btn red back-register">Voltar</a>
                        <button type="submit" class="btn green next-register">Avançar</button>

                        <div style="clear:both"></div>
                    </form>
                </div>
            </div>
        </div>
    </body>
    <script type="text/javascript" src="{{ url_for('static', filename='js/vendor.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script type="text/javascript">
        function searchEmail() {
            console.log('TO DO / CONSULTAR SE O E-MAIL JÁ EXISTE CADASTRADO NO BANCO')
        }

        function confirmPassword() {
            var password = $('#register-password').val()
            var confirm_password = $('#register-password-confirm').val()
            if (confirm_password != password) {
                document.getElementById('message').style.color = 'red';
                document.getElementById('message').innerHTML = 'As senhas não combinam, tente novamente';
            } else {
                document.getElementById('message').style.display = 'none';
            }
        }

        $(document).ready(function() {
            $('form').on('submit', function(event) {
            event.preventDefault();
            $.ajax({
                url: 'step1',
                method: "POST",
                data: $(this).serialize(),
                dataType: 'json',
                async: false,
                success: function(result) {
                    localStorage.setItem('register-email', result['register-mail']);
                    localStorage.setItem('register-password', result['register-password']);
                    localStorage.setItem('register-username', result['register-username']);
                    window.location.href = '?step=2'
                },
                error: function() {
                    alert("Ocorreu um erro ao carregar os dados.");
                }
            });
        })
    })
    </script>
</html>